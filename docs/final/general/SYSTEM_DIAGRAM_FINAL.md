# Nomad System Architecture Diagram

## System Overview

```
???????????????????????????????????????????????????????????????????
?                         USER INTERFACE                           ?
?  ????????????????????  ????????????????????  ????????????????? ?
?  ?   Web Browser    ?  ?   Mobile App     ?  ?   CLI Tool    ? ?
?  ?   (Next.js)      ?  ?   (Future)       ?  ?   (floyo)     ? ?
?  ????????????????????  ????????????????????  ????????????????? ?
???????????????????????????????????????????????????????????????????
            ?                      ?                    ?
            ? HTTP/WebSocket       ?                    ?
            ?                      ?                    ?
???????????????????????????????????????????????????????????????????
?                    FRONTEND LAYER                                ?
?  ??????????????????????????????????????????????????????????????? ?
?  ?  Next.js Application (frontend/)                           ? ?
?  ?  - React Components                                        ? ?
?  ?  - API Client (lib/api.ts) ?                              ? ?
?  ?  - State Management (Zustand)                              ? ?
?  ?  - i18n Support                                            ? ?
?  ?  - PWA Support                                             ? ?
?  ????????????????????????????????????????????????????????????? ?
???????????????????????????????????????????????????????????????????
                            ?
                            ? REST API / WebSocket
                            ?
???????????????????????????????????????????????????????????????????
?                    BACKEND API LAYER                            ?
?  ??????????????????????????????????????????????????????????????? ?
?  ?  FastAPI Application (backend/main.py)                      ? ?
?  ?  ????????????????  ????????????????  ???????????????????? ? ?
?  ?  ?   Auth API   ?  ?  Events API  ?  ?  Patterns API    ? ? ?
?  ?  ????????????????  ????????????????  ???????????????????? ? ?
?  ?  ????????????????  ????????????????  ???????????????????? ? ?
?  ?  ? Suggestions ?  ? Organizations?  ?   Workflows      ? ? ?
?  ?  ????????????????  ????????????????  ???????????????????? ? ?
?  ?  ????????????????  ????????????????                       ? ?
?  ?  ? Integrations?  ?  Audit Logs  ?                       ? ?
?  ?  ????????????????  ????????????????                       ? ?
?  ????????????????????????????????????????????????????????????? ?
?                          ?                                      ?
?  ????????????????????????????????????????????????????????????? ?
?  ?  Middleware Layer                                          ? ?
?  ?  - Authentication (JWT)                                    ? ?
?  ?  - Rate Limiting                                           ? ?
?  ?  - CORS                                                    ? ?
?  ?  - Security Headers                                        ? ?
?  ?  - Error Handling                                          ? ?
?  ????????????????????????????????????????????????????????????? ?
??????????????????????????????????????????????????????????????????
                            ?
                            ? SQLAlchemy ORM
                            ?
???????????????????????????????????????????????????????????????????
?                    DATABASE LAYER                               ?
?  ??????????????????????????????????????????????????????????????? ?
?  ?  PostgreSQL Database                                        ? ?
?  ?  ???????????????  ???????????????  ?????????????????????  ? ?
?  ?  ?   Users     ?  ?   Events    ?  ?    Patterns       ?  ? ?
?  ?  ???????????????  ???????????????  ?????????????????????  ? ?
?  ?  ???????????????  ???????????????  ?????????????????????  ? ?
?  ?  ?Suggestions ?  ?Organizations?  ?    Workflows       ?  ? ?
?  ?  ???????????????  ???????????????  ?????????????????????  ? ?
?  ?  ???????????????  ???????????????  ?????????????????????  ? ?
?  ?  ?Integrations?  ? Audit Logs   ?  ?  Experiments      ?  ? ?
?  ?  ???????????????  ???????????????  ?????????????????????  ? ?
?  ?  ???????????????  ???????????????                         ? ?
?  ?  ?FeatureFlags?  ? FraudScores ?                         ? ?
?  ?  ???????????????  ???????????????                         ? ?
?  ????????????????????????????????????????????????????????????? ?
???????????????????????????????????????????????????????????????????

???????????????????????????????????????????????????????????????????
?                    BACKGROUND JOBS LAYER                        ?
?  ??????????????????????????????????????????????????????????????? ?
?  ?  Workflow Scheduler (backend/workflow_scheduler.py) ??       ? ?
?  ?  - Cron-based execution                                      ? ?
?  ?  - Version management                                        ? ?
?  ?  - Rollback support                                          ? ?
?  ????????????????????????????????????????????????????????????? ?
?                          ?                                      ?
?  ????????????????????????????????????????????????????????????? ?
?  ?  Future Jobs:                                              ? ?
?  ?  - Pattern Analysis Automation ??                          ? ?
?  ?  - Data Retention Cleanup ??                                ? ?
?  ?  - Backup Automation ??                                     ? ?
?  ?  - DSAR Processing ??                                       ? ?
?  ????????????????????????????????????????????????????????????? ?
???????????????????????????????????????????????????????????????????

???????????????????????????????????????????????????????????????????
?                    EXTERNAL SERVICES (Future)                    ?
?  ????????????????  ????????????????  ???????????????????????   ?
?  ?   Stripe     ?  ?   PostHog    ?  ?    Slack/Email      ?   ?
?  ?  (Payments)  ?  ?  (Analytics) ?  ?   (Notifications)   ?   ?
?  ?     ?       ?  ?     ?       ?  ?       ??            ?   ?
?  ????????????????  ????????????????  ???????????????????????   ?
???????????????????????????????????????????????????????????????????

???????????????????????????????????????????????????????????????????
?                    OBSERVABILITY LAYER                          ?
?  ????????????????  ????????????????  ???????????????????????   ?
?  ?   Sentry     ?  ?   Logging   ?  ?   Health Checks     ?   ?
?  ?  (Errors)    ?  ?  (Structured)?  ?   (/health)         ?   ?
?  ?     ??       ?  ?     ?       ?  ?       ?            ?   ?
?  ????????????????  ????????????????  ???????????????????????   ?
?  ????????????????  ????????????????                            ?
?  ?   Metrics    ?  ?   Alerts     ?                            ?
?  ?   (Future)   ?  ?   (Future)   ?                            ?
?  ?     ?       ?  ?     ?       ?                            ?
?  ????????????????  ????????????????                            ?
???????????????????????????????????????????????????????????????????
```

## Connectivity Status Legend

- ? **Connected** - Fully operational
- ?? **Partial** - Implemented but needs configuration/automation
- ? **Missing** - Not yet implemented

## Key Components

### Frontend
- **Location:** `frontend/`
- **Framework:** Next.js 14
- **State:** Zustand
- **API Client:** `frontend/lib/api.ts` ?

### Backend
- **Location:** `backend/`
- **Framework:** FastAPI
- **Database:** SQLAlchemy + PostgreSQL
- **Auth:** JWT tokens
- **Routes:** 45 endpoints

### Database
- **Location:** `database/models.py`
- **Models:** 17 tables
- **Migrations:** Alembic

### Jobs
- **Scheduler:** `backend/workflow_scheduler.py`
- **Status:** Exists but needs cron registration ??

## Data Flow Examples

### User Registration Flow
```
User ? Frontend ? API Client ? Backend API ? Database
                                       ?
                                    JWT Token
                                       ?
                                  Frontend Store
```

### Event Tracking Flow
```
CLI/File Watcher ? Event API ? Database
                          ?
                    Pattern Analysis
                          ?
                    Suggestions Engine
```

### Workflow Execution Flow
```
Cron/Manual Trigger ? Workflow Scheduler ? Execute Steps
                                           ?
                                    Integration Connectors
                                           ?
                                    Audit Logging
```

## Integration Points

1. **Frontend ? Backend**: REST API + WebSocket ?
2. **Backend ? Database**: SQLAlchemy ORM ?
3. **Backend ? Cache**: Redis (optional) ??
4. **Backend ? Monitoring**: Sentry (optional) ??
5. **Workflows ? External**: Integration Connectors ??

## Missing Connections (To Implement)

1. **Stripe Webhooks** ? Payment processing
2. **PostHog/Segment** ? Analytics events
3. **Slack/Email** ? Notifications
4. **S3/Storage** ? DSAR artifacts
5. **PagerDuty/Slack** ? Alert routing
